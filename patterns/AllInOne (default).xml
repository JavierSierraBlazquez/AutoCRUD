<?xml version="1.0"?>
<Pattern id="p2" name="AllInOne (default)">
	
	<!-- PAGES SECTION-->
	<Pages>
		<Page id="CRUDPage" name="CRUDPage" landmark="true" x="30" y="30">
			<XOR id="Alternative" name="Alternative" x="0" y="0">
				<Page id="DefaultPage" name="DefaultPage" default="true" x="30" y="30">
					<NoOpContentUnit id="noOpContentUnit" name="New" x="5" y="5"/>
					<MultiMessageUnit id="mmu" name="MultiMessageUnit" x="0" y="150"/>
					<PowerIndexUnit id="piu" name="PowerIndexUnit" x="150" y="0"/>
				</Page>

				<Page id="DetailsPage" name="Details" landmark="true" x="400" y="5">
					<DataUnit id="du" name="DataUnit" x="0" y="0"/>					
				</Page>

				<Page id="FormPage" name="Form" landmark="true" x="5" y="300">
					<EntryUnit id="eu" name="EntryUnit" x="200" y="150"/>	
					<SelectorUnit id="selectorEntidad" name="Selector" type="keyCondition" x="100" y="5"/>			
				</Page>
			</XOR>
		</Page>
	</Pages>		


	<!-- OPERATION UNITS SECTION -->
	<OperationUnits>
		<CreateUnit id="createUnit" name="CreateUnit" x="700" y="500"/>
		<DeleteUnit id="deleteUnit" name="DeleteUnit" x="700" y="300"/>
		<UpdateUnit id="updateUnit" name="UpdateUnit"  x="700" y="800"/>
		<IsNotNullUnit id="isNotNullUnit" name="New ..." x="700" y="650"/>
	</OperationUnits>

	


	<!-- LINKS SECTION -->
	<Links>
		<NormalNavigationFlow id= "nnf1" name="Close" sourceId="du" targetId="mmu"/>
		<NormalNavigationFlow id= "nnf2" name="Cancel" sourceId="eu" targetId="mmu" validate="false"/>
		<NormalNavigationFlow id= "nnf3" name="New" sourceId="noOpContentUnit" targetId="selectorEntidad" type="fixedValue"/>
		<NormalNavigationFlow id= "nnf4" name="View" sourceId="piu" targetId="du"/>
		<NormalNavigationFlow id= "nnf5" name="Modify" sourceId="piu" targetId="selectorEntidad"/>
		<NormalNavigationFlow id= "nnf6" name="Delete" sourceId="piu" targetId="deleteUnit"/>
		<NormalNavigationFlow id= "nnf7" name="Accept" sourceId="eu" targetId="isNotNullUnit" type="isNotNull"/>

		<OKLink id="okDelete" sourceId="deleteUnit" targetId="mmu" message="Data deleted correctly"/>
		<OKLink id="okNN" sourceId="isNotNullUnit" targetId="updateUnit"/>

		<KOLink id="koDelete" sourceId="deleteUnit" targetId="mmu" message="Failed deleting data"/>
		<KOLink id="koCreate" sourceId="createUnit" targetId="mmu" message="Failed creating data"/>
		<KOLink id="koUpdate" sourceId="updateUnit" targetId="mmu" message="Failed modifying data"/>
		<KOLink id="koNN" sourceId="isNotNullUnit" targetId="createUnit"/>


		<DataFlow id="df1" name="Load" sourceId="selectorEntidad" targetId="eu" type="unitToEntry"/>
		<DataFlow id="df2" name="Load" sourceId="eu" targetId="createUnit" type="entryToCreate"/>
		<DataFlow id="df3" name="Load" sourceId="eu" targetId="updateUnit" type="entryToUpdate"/>
	</Links>


	<!-- RELATIONS SECTION -->
	<forEachRelation>
		<SelectorUnit id="selector#" name="selector#" entity="entityRelated" parentId="FormPage" x="300#" y="0"/>
		<DataFlow id="flowSelectorForm#" name="Load" sourceId="selector#" targetId="eu" type="preload"/>

		<IfNMRelation>
			<SelectorUnit id="selectorNM%" name="selectorNM%" entity="entityRelated" parentId="FormPage" type="roleCondition" x="0" y="130%"/>
			<DataFlow id="flowSelectSelect%" name="Load" sourceId="selectorEntidad" targetId="selectorNM%"/>
			<DataFlow id="flowSelectEntry%" name="Load" sourceId="selectorNM%" targetId="eu" type="unitToEntryRole"/>

			<ConnectUnit id="connect%" name="connect%" entity="entityRelated" x="850%" y="500"/>
			<DataFlow id="flowFormConnect%" name="Load" sourceId="eu" targetId="connect%" type="entryToConnect"/>
			<KOLink id="koConnect%" sourceId="connect%" targetId="mmu" message="Failed creating/modifying data"/>

			<ReconnectUnit id="reconnect%" name="reconnect%" entity="entityRelated" x="850%" y="800"/>
			<DataFlow id="flowFormReconnect%" name="Load" sourceId="eu" targetId="reconnect%" type="entryToReconnect"/>
			<KOLink id="koReconnect%" sourceId="reconnect%" targetId="mmu" message="Failed modifying data"/>


			<IfFirstRelation>
				<OKLink id="okConnect%" sourceId="createUnit" targetId="connect%"/>	
				<OKLink id="okReconnect%" sourceId="updateUnit" targetId="reconnect%"/>				
			</IfFirstRelation>

			<IfNotFirstRelation>
				<OKLink id="okConnect%" sourceId="connect%-1" targetId="connect%"/>
				<OKLink id="okReconnect%" sourceId="reconnect%-1" targetId="reconnect%"/>
			</IfNotFirstRelation>
		</IfNMRelation>
	</forEachRelation>

	<IfSomeNMRelation>
		<OKLink id="okConnect%+1" sourceId="connect%" targetId="mmu" message="Data created correctly"/>	
		<OKLink id="okReconnect%+1" sourceId="reconnect%" targetId="mmu" message="Data modified correctly"/>	
	</IfSomeNMRelation>
	<IfNotSomeNMRelation>
		<OKLink id="okConnect" sourceId="createUnit" targetId="mmu" message="Data created correctly"/>	
		<OKLink id="okReconnect" sourceId="updateUnit" targetId="mmu" message="Data modified correctly"/>		
	</IfNotSomeNMRelation>

</Pattern>


	<!-- # = número iterativo por cada relación -->
	<!-- % = número iterativo por cada relación NM-->

